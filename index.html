<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link href="https://fonts.googleapis.com/css?family=Nunito:400,700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./styles/style.css">
  <title>Follow the Colors!</title>
</head>
<body>
<!-- make buttons -->
<header>

  <div class="wrapper">  
    <h1>Follow the Colors!</h1>
    <div>
      <h2>Instructions</h3>
      <p> 1 - Turn on the game by clicking the "Power On" button and start button</p>
      <p> 2 - Wait for the color sequence to show.</p>
      <p> 3 - Click the correct colors in the order shown</p>
    </div>
  </div>
</header>
<main class="wrapper">

  <div class="powerArea">
    <div class="powerInputArea">
      <label for="powerButton"><h3>Power</h3></label>
      <input tabindex = 1 type="checkbox" id="powerButton" autocomplete="off">
    </div>
    <div class="startButton">
      <button tabindex = 1 id="start"><h3>Start</h3></button>
    </div>
    <div class="gameStatus">
      <h3>Game is Off turn the game on</h3>
    </div>
  </div>
<!-- colored buttons -->
  <div class="buttonContainer">
    <div class="buttons">
      <div>
        <button class="button" id="red"></button>
        <button class="button" id="blue"></button>
      </div>
      <div>
        <button class="button" id="green"></button>
        <button class="button" id="yellow"></button>
      </div>
    </div>
  </div>  

  <div class="gameInfo">
    <div class="level">
        <!-- level info is appended here -->
    </div>
    <div class="feedback">
        <!-- Whether answer is correct or not -->
    </div>
    <div>
      <form action="submit" id="form">
        <input type="text" id="name" placeholder="your name">
        <!-- <input type="text" id="score" placeholder="your score"> -->
        <input type="button" onclick="save()" value="Save">
      </form>
    </div>
    <div id="score">
      <ul id="scoreList"></ul>
    </div>
  </div>
</main>
<footer>
  Created By : Jamie Yeung 2019
</footer>
  <script src="script.js"></script>
  <!-- The core Firebase JS SDK is always required and must be listed first -->
  <script src="https://www.gstatic.com/firebasejs/6.3.4/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/6.0.1/firebase-database.js"></script>

  
  <!-- TODO: Add SDKs for Firebase products that you want to use
       https://firebase.google.com/docs/web/setup#config-web-app -->
  
  <script>
    // Your web app's Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyBsRhrADHoIybPJtzuOFcwEPccV63QyqFQ",
      authDomain: "colorprojectjy.firebaseapp.com",
      databaseURL: "https://colorprojectjy.firebaseio.com",
      projectId: "colorprojectjy",
      storageBucket: "",
      messagingSenderId: "729870807197",
      appId: "1:729870807197:web:f62299e0e3fa509f"
    };
 
    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);

        //do work
            dbRef = firebase.database().ref();

            const save = () =>{
              app.newScore = {};
              // will need to create the input/form dynamically
              // saves name and value in to score
              app.newScore.name = document.getElementById("name").value;
              app.newScore.score = app.level;
              dbRef.push(app.newScore);
              console.log(app.newScore);
            }
            dbRef.on('value', score => {
              const scores = Object.values(score.val()).map(function(obj){
                return obj;
              })
              const sorted = scores.sort((a,b) => b.score - a.score);
              console.log(sorted)
              listArr = []
              for(item in sorted){
                listArr.push(`<li>${sorted[item].name} - ${sorted[item].score}</li>`)              
              }
              console.log(listArr);
              let listArrTopFive = listArr.slice(0,5).join('');
              console.log(listArrTopFive);

              document.getElementById("scoreList").innerHTML = listArrTopFive;
            });



            // dbRef.orderByChild("score").on("value", function(data){
            //   app.fireValue = data.val();
            //   console.log(app.fireValue);




            //   app.fireArray = [];
            //   app.fireArrayNumber =[];           
            //   // gets the list of names
            //   // for(item in app.fireValue){
            //   //   app.fireArray.push(`<li>${(app.fireValue[item].name)} - ${app.fireValue[item].score}</li>`)
            //   // }
            //   // console.log(app.fireArray);
            // });

  </script>
</body>
</html>